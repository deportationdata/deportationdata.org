---
title: "Data documentation from EOUSA"
---

```{r}
library(tidyverse)
library(reactable)
library(glue)

options(
  reactable.theme = reactableTheme(
    backgroundColor = "#F4F6F7"
  )
)

# Store the data frame to access in cell functions
library(googlesheets4)
gs4_deauth()
doc_data <- read_sheet(
  "https://docs.google.com/spreadsheets/d/1Acckm7h-Hs690Tv6bvtKEg_9L2yITqp0QqN5hN2dhWw/edit?gid=0#gid=0"
)
```

We collect any government documents and information that shed light on the tables, fields, and values in government data systems. These include:

1. **Internal documentation**: The agency's own documentation of its data systems, including data dictionaries and codebooks.
2. **Training materials**: Training materials for agency staff on using data systems.
3. **Privacy Impact Assessments (PIAs)**: Documents which outline the fields collected in government data systems and how they interrelate, as required by the E-Government Act of 2002.
4. **System of Records Notices (SORNs)**: Similar but often distinct content to PIAs, required for public disclosure under the Privacy Act of 1974.
5. **Court documents**: Documents including sworn declarations from agency staff from litigation.


::: {.column-page-inset-right}

```{r}

# Store filtered data once at the top level
filtered_doc_data <- doc_data |>
  filter(Agency == "DOJ EOUSA", is.na(exclude)) |>
  mutate(Date = as.Date(Date)) |>
  mutate(
    Link = case_when(
      !is.na(Link) ~ Link,
      !is.na(BoxID) ~
        glue(
          "https://ucla.app.box.com/index.php?rm=box_download_shared_file&shared_name=9d8qnnduhus4bd5mwqt7l95kz34fic2v&file_id=f_{BoxID}"
        ),
      TRUE ~ NA_character_
    )
  ) |>
  select(Type, Title, Agency, Date, Link, Contributor)

filtered_doc_data |>
  reactable(
    searchable = TRUE,
    filterable = TRUE,
    pagination = FALSE,
    columns = list(
      Type = colDef(width = 200),
      Title = colDef(
        name = "Document",
        width = 600,
        cell = function(value, index) {
          url <- filtered_doc_data$Link[index]
          if (is.null(url) || is.na(url) || url == "" || length(url) == 0) {
            return(value)
          }
          htmltools::tags$a(href = url, target = "_blank", value)
        }
      ),
      Date = colDef(
        name = "Date",
        width = 200,
        cell = function(value) {
          if (is.na(value)) {
            return("")
          }
          month_abbr <- format(value, "%b")
          day_year <- format(value, "%e, %Y")
          if (nchar(month_abbr) == 3) {
            paste0(month_abbr, ". ", day_year)
          } else {
            paste0(month_abbr, " ", day_year)
          }
        }
      ), # Add comma here
      Link = colDef(show = FALSE),
      Contributor = colDef(show = FALSE),
      Agency = colDef(show = FALSE)
    )
  )
```

:::

Some documents were obtained via a [FOIA request](https://www.aclusocal.org/en/release-foia-documents-related-eoir-databases) by the [ACLU of Southern California](https://aclusocal.org), the [National Immigration Project of the National Lawyers Guild](https://nipnlg.org), and [Mission Action](https://www.missionaction.org).